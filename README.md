## Kubelet follows symlinks as root in /var/log from the /logs server endpoint
This vulnerability was discovered by Aqua security researcher Daniel Sagi, it was identified in the kubelet's file-serving functionality, which exposes a significant risk of privilege escalation and unauthorized access within the host system. 

You can read more about the vulnerability here:
https://blog.aquasec.com/kubernetes-security-pod-escape-log-mounts

In the Kubernetes environment, the kubelet establishes a directory structure within the host's /var/log directory to represent pods on the node. Within this structure, a file named 0.log (1) is observed, serving as a symbolic link (symlink) to the corresponding container log file located within the /var/lib/docker/containers directory. Simultaneously, the kubelet exposes a /logs/ endpoint (2) operating an HTTP file server in the /var/log directory (3), enabling access to log files for requests originating from the API Server.
If a pod with hostPath mount to /var/log is deployed, an attacker gains access to pod log files. By replacing a log file symlink with one pointing to sensitive files (e.g., /etc/shadow), the kubelet, with root permissions, follows the symlink during log retrieval, allowing unauthorized access to sensitive files on the host node. This exploitation could compromise the entire node and, consequently, the security of the Kubernetes cluster.

This method was tested on Kubernetes 1.15 and 1.13, and might affect other versions.
We tested on Kubelet 1.17.1, and it works.

## Exploit
Just run run.sh

chmod +x run.sh && ./run.sh


